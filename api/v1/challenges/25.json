{"success": true, "data": {"id": 25, "name": "Mock Kernel", "value": 483, "initial": 500, "decay": 75, "minimum": 50, "description": "We found my brother's old iMac but forgot the password, maybe you can help me get in?\n\nHe said he was working on something involving \"pointer authentication codes\" and \"a custom kernel\"?\nI can't recall...\n\nAttached is the original Snow Leopard kernel macho as well as the kernel running on the iMac.\n\n### Notes\n\nNote that we have backported patches for several known Snow Leopard N-Days!\nIt is our belief that the easiest way to solve this challenge is the intended solution.\n\nIf you want to create an image for local testing, follow the instructions here:\n1. https://github.com/jprx/how-to-install-snow-leopard-in-qemu\n1. Make sure you disable journaling so that you can edit the filesystem from your host if something breaks!\n1. Inside the VM, rename `/System/Library/Extensions/AppleProfileFamily.kext` to `AppleProfileFamily.kext.bak`.\n1. Delete `/mach_kernel` and replace it with the attached `mach_kernel.sigpwny` file (saved as `/mach_kernel`).\n1. Reboot the VM and then run `uname -v`, you should see the version string of `sigpwny:xnu-1456.1.2.6/BUILD/obj//RELEASE_X86_64`.\n1. Install Xcode 3.2 (`xcode3210a432.dmg`) inside the VM to get `gcc`.\n\n### Connecting to Our Instance\n\nPassword for the user `user` is `user`. Flag is ravi's password. The flag is also at `/flag`. You can also\nssh into the remote machine by (`inst-1234567890123456` is the ID of your instance):\n\n`ssh user@inst-1234567890123456 -J user@mock-bastion.chal.uiuc.tf:1337 -oHostKeyAlgorithms=+ssh-rsa -oUserKnownHostsFile=/dev/null -oStrictHostKeyChecking=no`\n\nInstancer: https://mock.chal.uiuc.tf/\n\n### Credits\n\n**author**: ravi (https://twitter.com/0xjprx)\n\n**Infrastructure and Deployment**: YiFei Zhu", "connection_info": null, "category": "pwn", "state": "visible", "max_attempts": 0, "type": "dynamic", "type_data": {"id": "dynamic", "name": "dynamic", "templates": {"create": "/plugins/dynamic_challenges/assets/create.html", "update": "/plugins/dynamic_challenges/assets/update.html", "view": "/plugins/dynamic_challenges/assets/view.html"}, "scripts": {"create": "/plugins/dynamic_challenges/assets/create.js", "update": "/plugins/dynamic_challenges/assets/update.js", "view": "/plugins/dynamic_challenges/assets/view.js"}}, "solves": 4, "solved_by_me": false, "attempts": 0, "files": ["/files/316d9b4a02cdd945b2e42a6e30d5315c/mach_kernel.orig", "/files/1c169d07f9c5f3bf325e58804d2e1c99/mach_kernel.sigpwny"], "tags": ["kernel", "extreme"], "hints": [{"id": 314, "cost": 0, "content": "all the cOOL kids are sending MSGs to each other these days"}], "view": "<div :class=\"getStyles()\" role=\"document\" x-data=\"Challenge\" x-init=\"id = 25\">\n  <div class=\"modal-content\">\n    <div class=\"modal-body py-4 px-4 px-sm-5\">\n\n      <div>\n        <button type=\"button\" class=\"btn-close float-end\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n\n        <ul class=\"nav nav-tabs\">\n          <li class=\"nav-item\">\n            <a class=\"nav-link active\" data-bs-target=\"#challenge\" @click=\"showChallenge()\">Challenge</a>\n          </li>\n\n          \n            <li class=\"nav-item\">\n              <a class=\"nav-link challenge-solves\" data-bs-target=\"#solves\" @click=\"showSolves()\">\n                \n                  4 Solves\n                \n              </a>\n            </li>\n          \n        </ul>\n      </div>\n\n      <div>\n        <div class=\"tab-content\">\n          <div role=\"tabpanel\" class=\"tab-pane fade show active\" id=\"challenge\">\n            <h2 class=\"challenge-name text-center pt-3\">\n              Mock Kernel\n            </h2>\n            <h3 class=\"challenge-value text-center\">\n              483\n            </h3>\n\n\n            \n              <div class=\"challenge-tags text-center pt-2 pb-3\">\n                \n                  \n                    <span class=\"challenge-tag badge bg-info\">kernel</span>\n                  \n                    <span class=\"challenge-tag badge bg-info\">extreme</span>\n                  \n                \n              </div>\n            \n\n            <span class=\"challenge-desc\"><p>We found my brother's old iMac but forgot the password, maybe you can help me get in?</p>\n<p>He said he was working on something involving &quot;pointer authentication codes&quot; and &quot;a custom kernel&quot;?\nI can't recall...</p>\n<p>Attached is the original Snow Leopard kernel macho as well as the kernel running on the iMac.</p>\n<h3>Notes</h3>\n<p>Note that we have backported patches for several known Snow Leopard N-Days!\nIt is our belief that the easiest way to solve this challenge is the intended solution.</p>\n<p>If you want to create an image for local testing, follow the instructions here:</p>\n<ol>\n<li><a href=\"https://github.com/jprx/how-to-install-snow-leopard-in-qemu\">https://github.com/jprx/how-to-install-snow-leopard-in-qemu</a></li>\n<li>Make sure you disable journaling so that you can edit the filesystem from your host if something breaks!</li>\n<li>Inside the VM, rename <code>/System/Library/Extensions/AppleProfileFamily.kext</code> to <code>AppleProfileFamily.kext.bak</code>.</li>\n<li>Delete <code>/mach_kernel</code> and replace it with the attached <code>mach_kernel.sigpwny</code> file (saved as <code>/mach_kernel</code>).</li>\n<li>Reboot the VM and then run <code>uname -v</code>, you should see the version string of <code>sigpwny:xnu-1456.1.2.6/BUILD/obj//RELEASE_X86_64</code>.</li>\n<li>Install Xcode 3.2 (<code>xcode3210a432.dmg</code>) inside the VM to get <code>gcc</code>.</li>\n</ol>\n<h3>Connecting to Our Instance</h3>\n<p>Password for the user <code>user</code> is <code>user</code>. Flag is ravi's password. The flag is also at <code>/flag</code>. You can also\nssh into the remote machine by (<code>inst-1234567890123456</code> is the ID of your instance):</p>\n<p><code>ssh user@inst-1234567890123456 -J user@mock-bastion.chal.uiuc.tf:1337 -oHostKeyAlgorithms=+ssh-rsa -oUserKnownHostsFile=/dev/null -oStrictHostKeyChecking=no</code></p>\n<p>Instancer: <a href=\"https://mock.chal.uiuc.tf/\">https://mock.chal.uiuc.tf/</a></p>\n<h3>Credits</h3>\n<p><strong>author</strong>: ravi (<a href=\"https://twitter.com/0xjprx\">https://twitter.com/0xjprx</a>)</p>\n<p><strong>Infrastructure and Deployment</strong>: YiFei Zhu</p>\n</span>\n\n            \n\n            \n              <div class=\"challenge-hints hint-row row\">\n                <div class=\"col-12 mb-3\">\n                \n                  <div x-data=\"Hint\" x-init=\"id = 314\">\n                    \n                    <details>\n                      <summary>View Hint</summary>\n                      <div><p>all the cOOL kids are sending MSGs to each other these days</p>\n</div>\n                    </details>\n                    \n                  </div>\n                \n                </div>\n              </div>\n            \n\n            \n              <div class=\"row challenge-files text-center pb-3\">\n                \n                  <div class=\"col-md-4 col-sm-4 col-xs-12 file-button-wrapper d-block\">\n                    \n                    \n                    \n                      \n                    \n                    <a\n                        class=\"btn btn-info btn-file mb-1 d-inline-block px-2 w-100 text-truncate\"\n                        href=\"/files/316d9b4a02cdd945b2e42a6e30d5315c/mach_kernel.orig\"\n                        title=\"mach_kernel.orig\"\n                    >\n                      <i class=\"fas fa-download\"></i>\n                      <small>\n                        mach_kernel.orig\n                      </small>\n                    </a>\n                  </div>\n                \n                  <div class=\"col-md-4 col-sm-4 col-xs-12 file-button-wrapper d-block\">\n                    \n                    \n                    \n                      \n                    \n                    <a\n                        class=\"btn btn-info btn-file mb-1 d-inline-block px-2 w-100 text-truncate\"\n                        href=\"/files/1c169d07f9c5f3bf325e58804d2e1c99/mach_kernel.sigpwny\"\n                        title=\"mach_kernel.sigpwny\"\n                    >\n                      <i class=\"fas fa-download\"></i>\n                      <small>\n                        mach_kernel.sigpwny\n                      </small>\n                    </a>\n                  </div>\n                \n              </div>\n            \n\n            \n\n            <div class=\"row submit-row\">\n              <div class=\"col-12 col-sm-8\">\n                \n                  <input\n                      id=\"challenge-id\" class=\"challenge-id\" type=\"hidden\"\n                      value=\"25\"\n                  >\n                  <input\n                      id=\"challenge-input\" class=\"challenge-input form-control\"\n                      type=\"text\" name=\"submission\"\n                      @keyup.enter=\"submitChallenge()\"\n                      placeholder=\"Flag\" x-model=\"submission\"\n                  >\n                \n              </div>\n\n              <div class=\"col-12 col-sm-4 mt-3 mt-sm-0 key-submit\">\n                \n                  <button\n                      id=\"challenge-submit\"\n                      class=\"challenge-submit btn btn-outline-secondary w-100 h-100\" type=\"submit\"\n                      @click.debounce.500ms=\"submitChallenge()\"\n                  >\n                    Submit\n                  </button>\n                \n              </div>\n            </div>\n\n            <div class=\"row notification-row\">\n              <div class=\"col-12\">\n                <template x-if=\"response\">\n                  \n                  <div\n                      :class=\"{\n                        'alert text-center w-100 mt-3 alert-success': response.data.status == 'correct',\n                        'alert text-center w-100 mt-3 alert-info': response.data.status == 'already_solved',\n                        'alert text-center w-100 mt-3 alert-danger': response.data.status == 'incorrect',\n                      }\" role=\"alert\"\n                  >\n                    <strong x-text=\"response.data.message\"></strong>\n                    <div x-show=\"(response.data.status == 'correct' || response.data.status == 'already_solved') && getNextId()\">\n                      <button @click=\"nextChallenge()\" class=\"btn btn-info mt-3\">Next Challenge</button>\n                    </div>\n                  </div>\n                </template>\n              </div>\n            </div>\n          </div>\n\n          <div role=\"tabpanel\" class=\"tab-pane fade\" id=\"solves\">\n            <div class=\"row\">\n              <div class=\"col-md-12\">\n                <table class=\"table table-striped text-center\">\n                  <thead>\n                  <tr>\n                    <td><b>Name</b>\n                    </td>\n                    <td><b>Date</b>\n                    </td>\n                  </tr>\n                  </thead>\n                  <tbody id=\"challenge-solves-names\">\n                  <template x-for=\"solve in solves\">\n                    <tr>\n                      <td>\n                        <a :href=\"solve.account_url\" x-text=\"solve.name\"></a>\n                      </td>\n                      <td x-text=\"solve.date\"></td>\n                    </tr>\n                  </template>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>"}}
